package com.linkedlist;

import java.util.HashMap;
import java.util.Map;

public class Node {
    int data;
    Node next;

    Node(int data) {
        this.data = data;
    }

    private static void traverse(Node head) {
        Node cur = head;
        while (cur != null) {
            System.out.print(cur.data + "->");
            cur = cur.next;
        }
        System.out.println();
    }

    private static void insert(int data, Node head, int pos) {
        Node toAdd = new Node(data);
        if (pos == 0) {
            toAdd.next = head;
            head = toAdd;
            return;
        }
        Node prev = head;
        for (int i = 0; i < pos - 1; i++) {
            prev = prev.next;
        }
        toAdd.next = prev.next;
        prev.next = toAdd;
    }

    private static void delete(Node head, int pos) {
        if (pos == 0) {
            head = head.next;
        }
        Node prev = head;
        for (int i = 0; i < pos - 1; i++) {
            prev = prev.next;
        }
        prev.next = prev.next.next;
    }

    private static void delete(Node node) {
        Node nextNode = node.next;
        node.data = nextNode.data;
        node.next = nextNode.next;
        nextNode = null;
    }


    private static Node reverseLinkedList(Node head) {
        // iterative method
        Node cur = head;
        Node prev = null;
        while (cur != null) {
            Node temp = cur.next;
            cur.next = prev;
            prev = cur;
            cur = temp;
        }
        return prev;
    }

    private static Node reverseLinkedListRecursive(Node head) {
        if (head == null || head.next == null)
            return head;
        Node newHead = reverseLinkedListRecursive(head.next);
        Node headNext = head.next;
        headNext.next = head;
        head.next = null;
        return newHead;
    }

    private static boolean isPalindrome(Node head) {
        if (head == null)
            return true;
        Node mid = middle(head);
        Node last = reverseLinkedList(mid.next);
        Node cur = head;
        while (last != null) {
            if (cur.data != last.data)
                return false;
            cur = cur.next;
            last = last.next;
        }
        return true;
    }

    private static Node middle(Node head) {
        Node slow = head;
        Node fast = head;
        while (fast != null && fast.next != null) {
            slow = slow.next;
            fast = fast.next.next;
        }
        return slow;
    }

    private static Node detectCycle(Node head) {
        Node slow = head;
        Node fast = head;
        while (fast != null && fast.next != null) {
            slow = slow.next;
            fast = fast.next.next;
            if (slow == fast)
                return slow;
        }
        return null;
    }

    private static Node detectFirstNode(Node head) {
        Node meet = detectCycle(head);
        Node start = head;
        while (start != meet) {
            start = start.next;
            meet = meet.next;
        }
        return meet;
    }

    private static Node mergeTwoList(Node head1, Node head2) {
        Node tempNode = new Node(0);
        Node currentNode = tempNode;

        while (head1 != null && head2 != null) {
            if (head1.data < head2.data) {
                currentNode.next = head1;
                head1 = head1.next;
            } else {
                currentNode.next = head2;
                head2 = head1.next;
            }
            currentNode = currentNode.next;
        }
        if (head1 != null) {
            currentNode.next = head1;
            head1 = head1.next;
        }

        if (head2 != null) {
            currentNode.next = head2;
            head2 = head2.next;
        }
        return tempNode.next;
    }

    private static Node deleteDuplicatesInASortedList(Node head) {
        Node cur = head;
        while (cur != null && cur.next != null) {
            if (cur.data == cur.next.data) {
                cur.next = cur.next.next;
            } else {
                cur = cur.next;
            }
        }
        return head;
    }

    private static Node deleteDuplicatesInAnUnSortedList(Node head) {
        Map<Integer, Integer> countMap = new HashMap<>();
        Node cur = head;
        Node prev = null;
        countMap.put(cur.data, 1);
        prev = cur;
        cur = cur.next;
        while (cur != null) {
            if (countMap.get(cur.data) != null) {
                prev.next = cur.next;
            } else {
                countMap.put(cur.data, 1);
                prev = cur;
            }
            cur = cur.next;
        }
        return head;
    }

    private static Node sortUsingDutchNationalFlagAlgorithm(Node head) {
        Node zerosD = new Node(0);
        Node onesD = new Node(0);
        Node twosD = new Node(0);

        Node zeros = zerosD;
        Node ones = onesD;
        Node twos = twosD;
        Node cur = head;
        while (cur != null) ;
        {
            if (cur.data == 0) {
                zeros.next = cur;
                zeros = zeros.next;
            } else if (cur.data == 1) {
                ones.next = cur;
                ones = ones.next;
            } else {
                twos.next = cur;
                twos = twos.next;

            }
            cur = cur.next;
        }
        zeros.next = onesD.next != null ? onesD.next : twosD.next;
        ones.next = twosD.next;
        twos.next = null;
        head = zerosD.next;

        return head;
    }

    private static Node removeNthNodeFromEndOfList(Node head, int n) {
        Node slow = head;
        Node fast = head;

        for (int i = 0; i < n; i++) {
            fast = fast.next;
        }
        while (fast != null && fast.next != null) {
            slow = slow.next;
            fast = fast.next;
        }
        slow.next = slow.next.next;
        return head;
    }

    public static void main(String[] args) {
//        Node n1 = new Node(10);
//        Node n2 = new Node(20);
//        Node n3 = new Node(30);
//
//        Node head1 = n1;
//        n1.next = n2;
//        n2.next = n3;
//        n3.next = null;

//        Node n4 = new Node(40);
//        Node n5 = new Node(50);
//        Node n6 = new Node(60);
//
//        Node head2 = n4;
//        n4.next = n5;
//        n5.next = n6;
//        n6.next = null;

//        Node resultMergeList = mergeTwoList(head1, head2);
//        traverse(resultMergeList);


//        traverse(head1);
//        delete(n2);
//        traverse(head);
//        insert(40, head, 1);
//        traverse(head);
//        delete(head, 3);
//        traverse(head);
//        reverseLinkedList(head);
//        System.out.println(isPalindrome(head));

//        Node n1 = new Node(2);
//        Node n2 = new Node(1);
//        Node n3 = new Node(2);
//
//        Node head = n1;
//        n1.next = n2;
//        n2.next = n3;
//        n3.next = null;
//        Node node = deleteDuplicatesInAnUnSortedList(head);
//        traverse(node);

//        Node n1 = new Node(0);
//        Node n2 = new Node(2);
//        Node n3 = new Node(1);
//
//        Node head = n1;
//        n1.next = n2;
//        n2.next = n3;
//        n3.next = null;
//
//        sortUsingDutchNationalFlagAlgorithm(head);
//        traverse(head);


        Node n1 = new Node(10);
        Node n2 = new Node(20);
        Node n3 = new Node(30);
        Node n4 = new Node(40);

        Node head = n1;
        n1.next = n2;
        n2.next = n3;
        n3.next = n4;
        n4.next = null;

        removeNthNodeFromEndOfList(head, 2);
        traverse(head);
    }


}


























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































